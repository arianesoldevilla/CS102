library(dplyr)
library(dbplyr)
library(RMariaDB)

connection <- dbConnect(RMariaDB::MariaDB(), 
                        dsn="mysql",
                        Server = "localhost",
                        dbname = "soldevilla_db", 
                        user = "root", 
                        password = '')
dbListTables(connection)

dbListFields(connection,"mov_rev")


posts_dta <- dbGetQuery(connection, "SELECT * FROM soldevilla_db.mov_rev")
glimpse(posts_dta)

empi_data <- dbGetQuery(connection, "SELECT * FROM soldevilla_db.mov_rev")
glimpse(empi_data)

empi_data[c(1:10),]

empi_data <- dbGetQuery(connection, "SELECT * FROM samplecs102.info")
tail(empi_data)

posts_data <- dbGetQuery(connection, "SELECT title,description FROM soldevilla_db.mov_rev")
posts_data[c(1:2),]

query1 <- "INSERT INTO mov_rev (title, user_name, rev_date, stars, rev_content) VALUES ('Luca', 'planktonrules', '17 November 2021', ' 8/10', 'Luca isn''t one of the deeper Pixar releases but it did have one thing that made it stand out for me...I liked it. The characters were enjoyable and the story, though simple, was delightful. The plot is actually much like Disney''s The Little Mermaid. It''s about some undersea creatures much like Selkies from Norse mythology...though the story is set in Italy. Luca is one of these creatures and although he doesn''t know it, like a Selkie, he can turn human when he leaves the water. At first, he''s scared when he discovers this, but when he meets Alberto, another such creature who has chosen to live on land, the pair become friends and soon go to the town of Portorosso. There, they make friends with Giulia as well as meet the town bully and all around jerk, Ercole. What''s next? See the film. Slight is definitely the word for this film. But its sweetness and characters made it a hit for me...and I nearly gave it a 9. Well worth seeing and a story with a nice message.')"
query2 <- "INSERT INTO mov_rev (title, user_name, rev_date, stars, rev_content) VALUES ('Poor Things', 'kjproulx', '6 January 2024', '8/10', 'For the reason that I''m completely unsure who this film is aimed at (aside from film lovers like myself), I will not be recommending this one, but I''ll also state that this is one of my favourite films in years. If that intrigues you, then maybe Poor Things is your cup of tea. Yorgos Lanthimos is a director with a clear vision that I deeply admire. I don''t love all of his work, but the worst I can say about any of his films is that I appreciate them. Well, Poor Things just jumped to the top of my list of favourite Lanthimos pictures. This is a pure work of art, in the weirdest, most bizarre way possible. I''m still trying to wrap my head around the brilliance of Poor Things. Let''s dive right in.The film begins as Dr. Godwin Baxter (Willem Dafoe) finds the dead body of a pregnant woman. After taking her corpse to his lab, he makes an incision and removes the baby from her body. He then takes out the woman''s brain and replaces it with her baby''s brain. Then, much like in the style of Frankenstein, he reanimates the body and she comes to life. He refers to her as Bella (Emma Stone) and refuses to let her leave home. Much like an infant, Bella learns to walk, speak, and also learns every detail of her body. Upon meeting Duncan Wedderburn (Mark Ruffalo), the two of them form a connection and flock away to roam the world together and get very intimate. That''s the jist of what sets this film in motion, so if that already turns you off, I would recommend not watching it.If you''re still intrigued, well then this film is a masterpiece. This story is told in a very unique style. As they visit real places in the world, it''s done in an incredibly artistic and surreal way. This film is aware that the premise is impossible, so it makes the visuals and details match the absurdity and I couldn''t get enough of it. The production designers, art directors, set decorator, costume designer, and the makeup department all deserve endless praise for their work here. They brought Lanthimos'' vision to life in stunning fashion. The look of this film blew me away, on top of me already loving the wackiness of the story.Honestly, all I want to do is gush about this film. The camerawork, the score, every performance, and even the incredibly worded dialogue all just made this a remarkable achievement. Emma Stone deserves an Oscar for her performance here too. I haven''t seen such an odd performance done this well and this committed in quite some time. She''s a true revelation here and her chemistry with Mark Ruffalo was hilarious. He also deserves all of the recognition he''s receiving for this.Poor Things is a very rare kind of filmmaking that doesn''t come around very often. Yes, it''s weird beyond what words could ever describe and I even watched a couple of people walk out of my screening, but I just can''t feel that way. The craft onscreen is undeniable and I could only dream of ever being able to make a film this masterful. In every conceivable way, I believe this is my favourite film of 2023. If you''re someone who is up for watching anything and willing to give anything a shot, I seriously can''t recommend this film enough. I''m currently adding it to my list of favourites, ever.')"
query3 <- "INSERT INTO mov_rev (title, user_name, rev_date, stars, rev_content) VALUES ('X', 'gortx', '31 March 2022', '10/10', 'Ti West''s movie really should have been called E for elevated. It sets itself up as a smart take on the slasher films of the 70s and early 80s. As a bonus, the film within a film has the filmmakers making an ''elevated'' porn flick (as a bonus, actor Owen Campbell who plays the Director even looks a bit like Director Tobe Hooper).Quite consciously taking it''s set up from Tobe Hooper''s 1974 TEXAS CHAINSAW MASSACRE, X has a group of randy pornographers renting a farmhouse from an elderly couple in the middle of nowhere in Texas (actually New Zealand). Writer-Director West''s main idea here is to set up a contrast between the XXX filmmakers and the bible thumping civilians of the area. It''s not an uninteresting idea, which, of course, plays off the the puritanical cliche in the slasher films of yore where the most sexually active characters are the most likely to g et killed off. In addition to MASSACRE, West includes nods to FRIDAY THE 13TH, Hooper''s EATEN ALIVE and a very specific one to HALLOWEEN. X is set about 5 years after MASSACRE so that it can include a brief exchange about how home video will change the porno industry (adult films were already available on VHS for about 3 years).The movie is very well directed, with savvy use of cross-cutting between the porn film in the making and the terrors that await the group. Mia Goth (in a dual role; actually a triple if you stay after the credits) and Brittany Snow are the two pornstars to be and each dive in with relish. Kid Cudi is the cocky stud, while Martin Henderson is solid as the confidant Producer. Jenna Ortega is the crew all by her lonesome (she manages to keep her clothes on - must have a better agent). Stephen Ure is the ornery old man who rents out his guest house.As good as the filmmaking is, X ends up feeling too studied. The pacing is lugubrious even if it picks up towards the very end. Once the massacre begins (if not by power tools) it still ends up being fairly typical of the films it''s commenting on, regardless of how well executed and ''elevated'' it thinks it is. It''s also too drawn out to satisfy some gore-hounds and once the blood starts flowing, probably too gross for the internet scribes dreaming of doing extended online essays dissecting it for it''s elevated intellect. There are a couple of twists, but they aren''t sufficient enough to compensate for the predictability.In the end, it''s not as clever as West thinks it is, and despite some good Directing chops and acting, it''s simply too self-conscious to be much of a fun thrill ride.')"
query4 <- "INSERT INTO mov_rev (title, user_name, rev_date, stars, rev_content) VALUES ('Marvels', 'Sleepin_Dragon', '10 November 2023', ' 8/10', 'Carol Danvers is attempting to save the universe, but her incredible powers become entangled with those of Kamala Khan and Monica Rambeau, they must unite to save the world.Ouch, what can you say, this is surely one of Marvel''s lowest points, I honestly don''t know who the target audience is, or who this is going to appeal to, young teens only maybe? Anyhow, this was an absolute mess.The writing was clearly problematic, it doesn''t gel, it is genuinely all over the place. I do very much wonder if huge sections of this film cut? It can be the only answer, it just doesn''t flow at all, and that short run time...Special effects, some were pretty good, some were poor, I just wish there was a greater focus on plot, it just seemed like 100 minutes of CGI, noise and random events.Brie Larson, I''m not sure about you, but to me she looked totally disinterested and bored by the whole thing, what I didn''t see, was someone committed to the role. I thought Samuel Jackson was rather good, but again poorly served by the script.It didn''t look great from the trailers, and in reality, it''s another clunker from Marvel Studios.4/10.' )"
query5 <- "INSERT INTO mov_rev (title, user_name, rev_date, stars, rev_content) VALUES ('Past Lives', 'evanston_dad', '11 July 2023', ' 7/10', 'Past Lives is like a Stephen Sondheim song come to life.You know the song The Road You Didn''t Take from Follies? How it''s all about the different doors that exist along the path of life, but you only get to enter one at a time, leaving you to wonder what was behind the other doors. And that one path isn''t necessarily better or worse than another, just different. And that you''ll never know what was behind the doors you didn''t choose, and that anyway time will eventually smooth over the regret you feel at not choosing them instead. Except that it doesn''t always, and you may never stop completely regretting the life you think you might have had, even if you don''t really mind the life you do have.This movie is that song. It''s watching a beautifully defined female character convince herself and her husband that her life is what she wants it to be, and that she doesn''t wish she''d taken a chance on the childhood sweetheart who comes back into her life after years apart and with whom she has off the charts chemistry. The actors who play the sweethearts as adults, Greta Lee and Teo Yoo, are both exceptional, but it''s Lee who creates the most fascinating character. A bit cold, a bit distant, not always even completely likable in a way that''s hard to define, a bit casually cruel to her husband who by anything the movie shows us can''t be judged as anything other than a good, solid, and super understanding guy. But then there''s that last scene that took my breath away, when we see the resolve not to feel emotions that would be inconvenient to feel give way, and we realize just how much has been roiling underneath the surface of Lee''s character all along. It''s magnificent and earned its right to leave me a quivering mess.The movie is also a sensitive look at what it feels like to be an immigrant, torn between two cultures, and not sure whether the nostalgia you feel is what you really want or just the allure of the familiar.A really great bit of counterprogramming in a summer that seems to be dishing up nothing but Marvel movies.Grade: A.')"
query6 <- "INSERT INTO mov_rev (title, user_name, rev_date, stars, rev_content) VALUES ('Barbie', 'LoveofLegacy', '21 July 2023', '8/10', 'Margot does the best with what she''s given, but this film was very disappointing to me. It was marketed as a fun, quirky satire with homages to other movies. It started that way, but ended with over-dramatized speeches and an ending that clearly tried to make the audience feel something, but left everyone just feeling confused. And before you say I''m a crotchety old man, I''m a woman in my 20s, so I''m pretty sure I''m this movie''s target audience. The saddest part is there were parents with their kids in the theater that were victims of the poor marketing, because this is not a kid''s movie. Overall, the humor was fun on occasion and the film is beautiful to look at, but the whole concept falls apart in the second half of the film and becomes a pity party for the strong woman.')"
query7 <- "INSERT INTO mov_rev (title, user_name, rev_date, stars, rev_content) VALUES ('The Creator', 'poseyfan', '29 September 2023', '8/10', 'This is a lesson to the movie industry on how to use a budget. 80 million dollars was used splendidly. The cinematography was amazing, (Not terribly surprising because Rogue One) acting was great, and the story was decent.It wasn''t without problems though. The story moves at an increasing pace and at some points you lose track of what''s happening. Suspension of disbelief will be needed in some moments.The theme of the story was to make AI to be more than just robots. I think they succeeded there, but at the expense of the humans. Most of the humans in the story ended up being one faced - except for Joshua.The dynamic between Joshua and Alfie was by far the best part of the movie. The acting was great between the two.It was a good movie. Not great by any means, but I''m all for supporting a movie that is trying something new.Overall, I think Gareth Edwards should be given some more projects. AND filmmakers everywhere should learn how a budget should be used.')"
query8 <- "INSERT INTO mov_rev (title, user_name, rev_date, stars, rev_content) VALUES ('Napoleon', 'imseeg', '23 November 2023', '8/10', 'A word of warning for those expecting another Gladiator or non stop action spectacle. It is not. Truly not...The bad: director Ridley Scott knows how to make action scenes look slick and impressive (and he does an excellent job again), but he is also known for being quite average at making a drama. And this movie tries (and partly fails) to combine action and drama and somehow ends up being neither one. THAT is one of the reasons I''ll only rate it with 6 stars.More bad: this story has a weak dramatic middle (love story) part, which is kinda tedious. And that brings me to a storyline complaint, namely that this story is all over the place. They cram SO much events and history and different characters from different time periods into this one movie that it kinda confused and numbed me down, instead of thrilling me, as an epic should do.This movie was made for Apple streaming (release date january 2024) in the first place, but they made a shorter (butchered) version for the cinemas in order to be able to compete for the Oscars, which demands that a movie must have run in the cinemas for a couple of weeks. No cinema version, no Oscars.The original Apple streaming version lasted some 2 hours longer. Nobody is gonna sit in the cinema for over 4 hours, hence they cut this movie up and now it feels somewhat rushed, confusing and disjointed at certain moments.Not any good then? Joaquin Phoenix is the one redeeming feature. He nails it.. He makes Napoleon look like a complete joke of a man and I love Joaquin Phoenix'' performance, but that unfortunately didnt compensate for the other actors being just about average and with little actor''s chemistry between them.I had been warned beforehand by friends that this wasnt the spectacle or epic drama they were hoping for and unfortunately they were right. Certainly not a terrible movie, but one that is just about average.Thank you for reading my 2100 th review on Imdb.')"
query9 <- "INSERT INTO mov_rev (title, user_name, rev_date, stars, rev_content) VALUES ('Fury', 'Sleepin_Dragon', '14 January 2023', '10/10', 'Where to even begin.... I don''t make out to be a historian, but I take a keen interest in this time period, it''s a fascinating, horrendous era, this .... doesn''t give any historical fact or detail, it''s basically a shoot ''em up movie which happens to be set during The Second World War.It surprises me that they didn''t have someone beating Hitler up, uppercutting Goebbels in a bunker action sequence.The Second World War, Hollywood style, some white amazing looking action sequences throughout, it''s incredibly atmospheric, you can almost smell the gunpowder and feel the tension.I hate myself for saying it, but I love this film, it''s Brad Pitt and Shia laBeouf both absolutely nailing it.If you watch any reviews, or read many of the written reviews, you''d come away thinking this film wasn''t worth your time, my advice would be to try it, but know what you''re getting.It''s absurd, but it''s so enjoyable.8/10.')"
query10 <- "INSERT INTO mov_rev (title, user_name, rev_date, stars, rev_content) VALUES ('Midsommar', 'imseeg', '29 May 2022', '10/10', 'This is really weird stuff. Not real horror, but more of a psychological mindbender.The bad: it doesnt really get scary or thrilling. It gets weird allright.The good: decent acting in a incredibly weird mindbending script.Not suited for casual viewers.')"

query_result1 <- dbSendQuery(connection, query1)
query_result2 <- dbSendQuery(connection, query2)
query_result3 <- dbSendQuery(connection, query3)
query_result4 <- dbSendQuery(connection, query4)
query_result5 <- dbSendQuery(connection, query5)
query_result6 <- dbSendQuery(connection, query6)
query_result7 <- dbSendQuery(connection, query7)
query_result8 <- dbSendQuery(connection, query8)
query_result9 <- dbSendQuery(connection, query9)
query_result10 <- dbSendQuery(connection, query10)
glimpse(empi_data)
dbClearResult(query_result)

dbDisconnect(connection)